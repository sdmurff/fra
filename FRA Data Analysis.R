library("dplyr")

F55a <- read.csv("/Users/murff/Downloads/Injury_Illness_Summary_-_Casualty_Data__Form_55a__20241212.csv")
F54 <- read.csv("/Users/murff/Downloads/Rail_Equipment_Accident_Incident_Data__Form_54__20241212.csv")
F54_UT <- F54 |>
  mutate(Date = as.Date(Date, format = "%m/%d/%Y")) |>
  filter(State.Name=="UTAH",
         Date > as.Date("11/28/2012", format = "%m/%d/%Y"))


F55a_UT <- F55a |>
  mutate(Date = as.Date(Date, format = "%m/%d/%Y")) |>
  filter(State.Name=="UTAH",
         Type.Of.Person %in% c("Nontrespassersâ€“On Railroad Property","Trespassers"),
         Date > as.Date("11/28/2012", format = "%m/%d/%Y"))

F57 <- read.csv("/Users/murff/Downloads/Highway-Rail_Grade_Crossing_Accident_Data__Form_57__20241212.csv")

F57_UT <- F57 |>
  mutate(Date = as.Date(Date, format = "%m/%d/%Y")) |>
  filter(State.Name=="UTAH",
         Date > as.Date("11/28/2012", format = "%m/%d/%Y"))

F57_Utah_QZ <- utah_quiet_zones |>
  inner_join(F57_UT,by = c("Crossing.ID" = "Grade.Crossing.ID"))

F57_Utah_QZ <- F57_Utah_QZ |>
  select(Crossing.ID,
         City.Name.x,
         Street,
         THR.Request.No,
         Latitude,
         Longitude,
         Incident.Number,
         Date,
         Time,
         County.Name,
         State.Name,
         City.Name.y,
         Highway.Name,
         Public.Private,
         Highway.User,
         Equipment.Struck,
         Train.Speed,
         User.Age,
         User.Gender,
         Highway.User.Action,
         View.Obstruction,
         Driver.In.Vehicle,
         Crossing.Users.Killed,
         Crossing.Users.Injured,
         Number.Vehicle.Occupants,
         Narrative,
         Total.Killed.Form.57,
         Total.Injured.Form.57,
         Total.Killed.Form.55A,
         Total.Injured.Form.55A,
         )

write.csv(F57_Utah_QZ, "/Users/murff/Downloads//Utah_QZ_Deaths2.csv")




F54_726161 <- F54_UT |>
  mutate(Date = as.Date(Date, format = "%m/%d/%Y")) |>
  filter(Accident.Number == "0726161",
         Date > as.Date("11/28/2012", format = "%m/%d/%Y"))

write.csv(F54_726161, "/Users/murff/Downloads/F54_726161.csv")
    



F54_5161901 <- F54_UT |>
  mutate(Date = as.Date(Date, format = "%m/%d/%Y")) |>
  filter(Accident.Number == "05161901",
         Date > as.Date("11/28/2012", format = "%m/%d/%Y"))

write.csv(F54_5161901, "/Users/murff/Downloads/F54_5161901.csv")


F55a_1214UT002 <- F55a_UT |>
  mutate(Date = as.Date(Date, format = "%m/%d/%Y")) |>
  filter(Incident.Number == "1214UT002",
         Date > as.Date("11/28/2012", format = "%m/%d/%Y"))

write.csv(F55a_1214UT002, "/Users/murff/Downloads/F55a_1214UT002.csv")












































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































